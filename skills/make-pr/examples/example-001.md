> this is example
---
## ğŸ“Œ Summary
ì´ë²ˆ PRì€ **ë„ë©”ì¸ ê°„ ê°•í•œ ê²°í•© ë¬¸ì œ**ì™€ **Application ë ˆì´ì–´ì˜ ê³¼ë„í•œ ì±…ì„ ì§‘ì¤‘ ë¬¸ì œ**ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë¥¼ ë„ì…í•˜ê³ , ë ˆì´ì–´ë³„ ì±…ì„ì„ ëª…í™•íˆ ë¶„ë¦¬í–ˆìŠµë‹ˆë‹¤.

**ì£¼ìš” ë³€ê²½ì‚¬í•­:**
- **ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ ë„ì…**: Commandì™€ Eventë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì£¼ë¬¸-ê²°ì œ í”Œë¡œìš°ë¥¼ ëŠìŠ¨í•˜ê²Œ ì—°ê²°í•˜ì—¬ ë„ë©”ì¸ ê°„ ì˜ì¡´ì„±ì„ ì œê±°í–ˆìŠµë‹ˆë‹¤. ì¬ê³  ì°¨ê°ì€ ì¦‰ì‹œ ì •í•©ì„±ì´ í•„ìš”í•˜ë¯€ë¡œ ë™ì¼ íŠ¸ëœì­ì…˜ì—ì„œ ì²˜ë¦¬í•˜ê³ , ì¿ í°/í¬ì¸íŠ¸/ê²°ì œëŠ” ì´ë²¤íŠ¸ë¥¼ í†µí•´ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.
- **ë ˆì´ì–´ë³„ ì±…ì„ ë¶„ë¦¬**: EventëŠ” ë„ë©”ì¸ ë ˆì´ì–´ì—, EventHandlerëŠ” Application ë ˆì´ì–´ì—, EventPublisher êµ¬í˜„ì²´ëŠ” Infrastructure ë ˆì´ì–´ì— ë°°ì¹˜í•˜ì—¬ ê° ë ˆì´ì–´ì˜ ì±…ì„ì„ ëª…í™•íˆ í–ˆìŠµë‹ˆë‹¤.
- **ë³´ìƒ íŠ¸ëœì­ì…˜ êµ¬í˜„**: ê²°ì œ ì‹¤íŒ¨ ì‹œ ì¬ê³ ì™€ í¬ì¸íŠ¸ë¥¼ ì›ë³µí•˜ëŠ” ë³´ìƒ íŠ¸ëœì­ì…˜ì„ ì¶”ê°€í•˜ê³ , ë©±ë“±ì„± ë³´ì¥ê³¼ Deadlock ë°©ì§€ë¥¼ ìœ„í•œ ë™ì‹œì„± ì œì–´ë¥¼ ì ìš©í–ˆìŠµë‹ˆë‹¤.
- **Application ë ˆì´ì–´ ë¦¬íŒ©í† ë§**: payment ë„ë©”ì¸ì„ ë¶„ë¦¬í•˜ê³ , ë„ë©”ì¸ë³„ Application ì„œë¹„ìŠ¤ë¡œ í†µí•©í•˜ì—¬ FacadeëŠ” ì—¬ëŸ¬ ë„ë©”ì¸ ì¡°í•©ë§Œ ë‹´ë‹¹í•˜ë„ë¡ ê°œì„ í–ˆìŠµë‹ˆë‹¤. ë˜í•œ DIPë¥¼ ì¤€ìˆ˜í•˜ì—¬ Application ë ˆì´ì–´ê°€ Infrastructureë¥¼ ì§ì ‘ ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ ê°œì„ í–ˆìŠµë‹ˆë‹¤.

ë©˜í† ë§ ì‹œê°„ë•Œ í”¼ë“œë°±í•´ì£¼ì‹  ë„ë©”ì¸ ë ˆì´ì–´ì—ì„œ ì´ë²¤íŠ¸ ë°œí–‰í•˜ë„ë¡ ì²˜ë¦¬í•˜ëŠ” ê²ƒ, ì–´í”Œë¦¬ì¼€ì´ì…˜ ë ˆì´ì–´ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ë‘ëŠ” ê²ƒ, ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒ ë“±ì€ ì‹œê°„ì´ ë¶€ì¡±í•˜ì—¬ ì´ë²ˆ PRì—ëŠ” ë°˜ì˜í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë¶€ì¡±í•œ ì  ë³´ì™„í•˜ì—¬ ë‹¤ìŒì£¼ PRì— í¬í•¨í•˜ê² ìŠµë‹ˆë‹¤.

## ğŸ’¬ Review Points

###  1. ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ ë„ì…

ì£¼ë¬¸, ì¢‹ì•„ìš”ì²˜ëŸ¼ ì—¬ëŸ¬ ë„ë©”ì¸ì˜ ì„œë¹„ìŠ¤ë¥¼ ì§ì ‘ ì˜ì¡´í•˜ë˜ êµ¬ì¡°ë¥¼ Commandì™€ Eventë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ëŠìŠ¨í•˜ê²Œ ì—°ê²°ë˜ë„ë¡ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤. ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ëŠ” ì´ë¯¸ ì¼ì–´ë‚œ ì‚¬ì‹¤(Event)ì„ ì¤‘ì‹¬ìœ¼ë¡œ ë„ë©”ì¸ ê°„ í˜‘ì—…ì„ êµ¬ì„±í•¨ìœ¼ë¡œì¨, ê° ë„ë©”ì¸ì´ ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ë‚´ë¶€ êµ¬í˜„ì— ì˜ì¡´í•˜ì§€ ì•Šê³ ë„ í•„ìš”í•œ ì •ë³´ë¥¼ ì „ë‹¬ë°›ì„ ìˆ˜ ìˆì–´ ë„ë©”ì¸ê°„ ì˜ì¡´ì„±ì„ ì—†ì•¨ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

#### 1) Commandì™€ Event ê¸°ë°˜ ì„¤ê³„

ë„ë©”ì¸ë³„ë¡œ ì£¼ë¬¸ ìƒì„±, ì¿ í° ì ìš©, í¬ì¸íŠ¸ ì°¨ê°, ê²°ì œ ìš”ì²­, ì¢‹ì•„ìš” ë“± ì‹œìŠ¤í…œì—ì„œ ìˆ˜í–‰ë  ìˆ˜ ìˆëŠ” ì£¼ìš” **Command**(ì‚¬ìš©ìì˜ ì˜ë„)ë¥¼ ì‹ë³„í•˜ê³ , ê° Commandê°€ ì‹¤í–‰ë˜ì—ˆì„ ë•Œ **Event**(ì´ë¯¸ ì¼ì–´ë‚œ ì‚¬ì‹¤)ë“¤ì„ ë„ì¶œí–ˆìŠµë‹ˆë‹¤.

ì´í›„ Eventë³„ë¡œ ì–´ë–¤ ë„ë©”ì¸ì´ ê´€ì‹¬ì„ ê°€ì§€ëŠ”ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í›„ì† Commandë¥¼ ì—°ê²°í•˜ì—¬, ì£¼ë¬¸ ìƒì„± íë¦„ì„ ë‹¤ìŒê³¼ ê°™ì€ ì´ë²¤íŠ¸ ê¸°ë°˜ í˜‘ì—… êµ¬ì¡°ë¡œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤:

```
CreateOrderCommand (PurchasingFacade.createOrder)
   â†“
 OrderCreatedEvent ë°œí–‰ (OrderService.create)
   â†“
 [ProductEventHandler] ì¬ê³  ì°¨ê° (BEFORE_COMMIT)
 [CouponEventHandler] ì¿ í° ì ìš© (AFTER_COMMIT)
 [PointEventHandler] í¬ì¸íŠ¸ ì°¨ê° (AFTER_COMMIT)
 [PurchasingFacade] PaymentEvent.PaymentRequested ë°œí–‰ (AFTER_COMMIT)
 [PaymentEventHandler] Payment ìƒì„± ë° PG ê²°ì œ ìš”ì²­ (AFTER_COMMIT)
```

#### Before: ë„ë©”ì¸ ê°„ ì§ì ‘ ì˜ì¡´

```java
// PurchasingFacade.java
@Component
public class PurchasingFacade {
    private final UserService userService;
    private final CouponService couponService;
    private final PaymentService paymentService;
    private final OrderService orderService;

    @Transactional
    public OrderInfo createOrder(...) {
        // ì£¼ë¬¸ ìƒì„±
        Order order = orderService.create(...);

        // ì¿ í° ì ìš© (ì§ì ‘ í˜¸ì¶œ)
        couponService.applyCoupon(userId, couponCode, subtotal);

        // í¬ì¸íŠ¸ ì°¨ê° (ì§ì ‘ í˜¸ì¶œ)
        userService.deductPoint(userId, usedPoint);

        // ê²°ì œ ìš”ì²­ (ì§ì ‘ í˜¸ì¶œ)
        paymentService.requestPayment(...);

        // ì£¼ë¬¸ ë„ë©”ì¸ì´ ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ë‚´ë¶€ ê·œì¹™ì— ê°œì…
    }
}
```

**ë¬¸ì œì :**
- ì£¼ë¬¸ ë„ë©”ì¸ì´ ì¿ í°, í¬ì¸íŠ¸, ê²°ì œ ë„ë©”ì¸ì˜ ë‚´ë¶€ ê·œì¹™ì— ì§ì ‘ ê°œì…
- ë„ë©”ì¸ ê°„ ê°•í•œ ê²°í•©ìœ¼ë¡œ ì¸í•œ ë³€ê²½ ì˜í–¥ë„ ì¦ê°€
- íŠ¸ëœì­ì…˜ ê²½ê³„ê°€ ëª¨í˜¸í•¨
- ê° ë„ë©”ì¸ì´ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘í•˜ê¸° ì–´ë ¤ì›€

#### After: ì´ë²¤íŠ¸ ê¸°ë°˜ í˜‘ì—… êµ¬ì¡°

```java
// application/order/OrderService.java
@Service
public class OrderService {
    private final OrderEventPublisher orderEventPublisher;

    @Transactional
    public Order create(CreateOrderCommand command) {
        Order order = Order.of(command.userId(), command.items(), command.couponCode(), 0);
        Order savedOrder = orderRepository.save(order);

        // âœ… OrderCreatedEvent ë°œí–‰ (ì´ë¯¸ ì¼ì–´ë‚œ ì‚¬ì‹¤)
        orderEventPublisher.publish(OrderEvent.OrderCreated.from(savedOrder, command.subtotal(), command.usedPointAmount()));

        return savedOrder;
    }
}

// application/coupon/CouponEventHandler.java
@Component
public class CouponEventHandler {
    private final CouponService couponService;

    @Transactional
    public void handleOrderCreated(OrderEvent.OrderCreated event) {
        // âœ… OrderCreatedEventë¥¼ êµ¬ë…í•˜ì—¬ ì¿ í° ì ìš© Command ì‹¤í–‰
        if (event.couponCode() != null) {
            couponService.applyCoupon(
                new ApplyCouponCommand(event.userId(), event.couponCode(), event.subtotal())
            );
        }
    }
}

// application/user/PointEventHandler.java
@Transactional
public void handleOrderCreated(OrderEvent.OrderCreated event) {
    // âœ… OrderEvent.OrderCreatedë¥¼ êµ¬ë…í•˜ì—¬ í¬ì¸íŠ¸ ì°¨ê° Command ì‹¤í–‰
    if (event.usedPointAmount() == null || event.usedPointAmount() == 0) {
        return;
    }
    DeductPointCommand command = new DeductPointCommand(event.userId(), event.usedPointAmount());
    user.deductPoint(Point.of(command.usedPointAmount()));
    userService.save(user);
}

// application/payment/PaymentEventHandler.java
@Component
public class PaymentEventHandler {
    private final PaymentService paymentService;

    @Transactional
    public void handlePaymentRequested(PaymentEvent.PaymentRequested event) {
        // âœ… PaymentRequestedEventë¥¼ êµ¬ë…í•˜ì—¬ ê²°ì œ ìš”ì²­ Command ì‹¤í–‰
        Payment payment = paymentService.create(...);
        // ê²°ì œ ì²˜ë¦¬ ë¡œì§...
    }
}
```

**ê°œì„  íš¨ê³¼:**
- ë„ë©”ì¸ ê°„ ëŠìŠ¨í•œ ê²°í•©: ì£¼ë¬¸ ë„ë©”ì¸ì´ ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ë‚´ë¶€ ê·œì¹™ì— ê°œì…í•˜ì§€ ì•ŠìŒ
- íŠ¸ëœì­ì…˜ ê²½ê³„ ëª…í™•í™”: ê° ë„ë©”ì¸ì´ ìì‹ ì˜ íŠ¸ëœì­ì…˜ ê²½ê³„ ë‚´ì—ì„œ ë™ì‘
- ë…ë¦½ì ì¸ ë™ì‘: ê° ë„ë©”ì¸ì´ ìì‹ ì˜ ê·œì¹™ì— ë”°ë¼ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘
- í™•ì¥ì„± í–¥ìƒ: ìƒˆë¡œìš´ ë„ë©”ì¸ ì¶”ê°€ ì‹œ ì´ë²¤íŠ¸ë§Œ êµ¬ë…í•˜ë©´ ë¨

#### 2) ì¬ê³  ì°¨ê°ì€ ì¦‰ì‹œ ì²˜ë¦¬

ì¬ê³ ëŠ” ì£¼ë¬¸ ìƒì„±ê³¼ ë™ì‹œì— ì°¨ê°ë˜ì–´ì•¼ í•˜ë©°, ì£¼ë¬¸ì´ ì·¨ì†Œë˜ë©´ ì¦‰ì‹œ ì›ë³µë˜ì–´ì•¼ í•˜ëŠ” ì¦‰ì‹œ ì •í•©ì„±ì´ í•„ìš”í•œ ì˜ì—­ì…ë‹ˆë‹¤. ë°˜ë©´ ì¿ í°, í¬ì¸íŠ¸, ê²°ì œëŠ” ì£¼ë¬¸ ìƒì„± í›„ ì¼ì • ì‹œê°„ ë‚´ì— ì²˜ë¦¬ë˜ë©´ ë˜ëŠ” ìµœì¢… ì¼ê´€ì„±ìœ¼ë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ ì¬ê³  ì°¨ê°ì€ ì£¼ë¬¸ ìƒì„±ê³¼ ë™ì¼í•œ íŠ¸ëœì­ì…˜ì—ì„œ ì²˜ë¦¬í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ì´ë²¤íŠ¸ë¥¼ í†µí•´ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

```java
// application/product/ProductEventHandler.java
@Component
public class ProductEventHandler {
    private final ProductService productService;

    @Transactional
    public void handleOrderCreated(OrderEvent.OrderCreated event) {
        // âœ… ì¬ê³  ì°¨ê°ì€ ì¦‰ì‹œ ì •í•©ì„±ì´ í•„ìš”í•˜ë¯€ë¡œ ë™ì¼ íŠ¸ëœì­ì…˜ì—ì„œ ì²˜ë¦¬
        for (OrderEvent.OrderCreated.OrderItemInfo itemInfo : event.orderItems()) {
            Product product = productService.getProductForUpdate(itemInfo.productId());
            DeductStockCommand command = new DeductStockCommand(itemInfo.productId(), itemInfo.quantity());
            product.decreaseStock(command.quantity());
        }
        productService.saveAll(...);
    }
}
```

#### 3) ì´ë²¤íŠ¸ ê¸°ë°˜ íë¦„ ì˜ˆì‹œ

ì£¼ë¬¸ ìƒì„±ë¶€í„° ì™„ë£Œê¹Œì§€ì˜ ì´ë²¤íŠ¸ ê¸°ë°˜ íë¦„:

```
1. CreateOrderCommand
   â†“
2. OrderCreatedEvent ë°œí–‰
   â†“
3. [ProductEventHandler] DeductStockCommand (ì¬ê³  ì°¨ê°)
   â†“
4. [CouponEventHandler] ApplyCouponCommand â†’ CouponAppliedEvent
   â†“
5. [PointEventHandler] DeductPointCommand (í¬ì¸íŠ¸ ì°¨ê°)
   â†“
6. [PaymentEventHandler] RequestPaymentCommand â†’ PaymentRequestedEvent
   â†“
7. [OrderEventHandler] OrderCompletedEvent (ê²°ì œ ì™„ë£Œ ì‹œ)
```

**í•µì‹¬ ì›ì¹™:**
- **Command**: ì‚¬ìš©ìì˜ ì˜ë„ (CreateOrder, ApplyCoupon, DeductPoint, RequestPayment ë“±)
- **Event**: ì´ë¯¸ ì¼ì–´ë‚œ ì‚¬ì‹¤ (OrderCreated, CouponApplied, PaymentRequested ë“±)
- ê° ë„ë©”ì¸ì€ ìì‹ ì´ ê´€ì‹¬ ìˆëŠ” Eventë¥¼ êµ¬ë…í•˜ì—¬ í›„ì† Commandë¥¼ ì‹¤í–‰
- ì¬ê³ ì²˜ëŸ¼ ì¦‰ì‹œ ì •í•©ì„±ì´ í•„ìš”í•œ ì˜ì—­ë§Œ ë™ì¼ íŠ¸ëœì­ì…˜ì—ì„œ ì²˜ë¦¬
---

### 2. ì´ë²¤íŠ¸ ê´€ë ¨ ë¡œì§ë“¤ì˜ ë ˆì´ì–´ë³„ ë°°ì¹˜

ê° ì´ë²¤íŠ¸ëŠ” ë„ë©”ì¸ì— ëŒ€í•œ ê·œì¹™ì„ í‘œí˜„í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— domain ë ˆì´ì–´ì— eventë¥¼ ë„£ê³ , ì–´í”Œë¦¬ì¼€ì´ì…˜ ë ˆì´ì–´ì—ì„œ event handlerê°€ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë ˆì´ì–´ë¥¼ ë¶„ë¦¬í–ˆìŠµë‹ˆë‹¤.
```java
// domain/order/OrderEvent.java - ë„ë©”ì¸ ë ˆì´ì–´ì— Event ì •ì˜
public class OrderEvent {
    public record OrderCreated(
        Long orderId,
        String userId,
        List<OrderItemInfo> orderItems,
        Long subtotal,
        Long usedPointAmount,
        String couponCode
    ) {
        public static OrderCreated from(Order order, Long subtotal, Long usedPointAmount) {
            // ë„ë©”ì¸ ê·œì¹™ì„ í‘œí˜„í•˜ëŠ” Event
            return new OrderCreated(...);
        }
    }
}

// application/order/OrderService.java - Application ë ˆì´ì–´
@Service
public class OrderService {
    private final OrderEventPublisher orderEventPublisher;  // âœ… ë„ë©”ì¸ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´

    @Transactional
    public Order create(CreateOrderCommand command) {
        Order order = Order.of(...);
        Order savedOrder = orderRepository.save(order);

        // âœ… ë„ë©”ì¸ Event ë°œí–‰
        orderEventPublisher.publish(OrderEvent.OrderCreated.from(savedOrder, ...));

        return savedOrder;
    }
}

// application/coupon/CouponEventHandler.java - Application ë ˆì´ì–´
@Component
public class CouponEventHandler {
    private final CouponService couponService;  // âœ… Application ì„œë¹„ìŠ¤ ì‚¬ìš©

    @Transactional
    public void handleOrderCreated(OrderEvent.OrderCreated event) {
        // âœ… Event Handlerê°€ Application ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©
        couponService.applyCoupon(
            new ApplyCouponCommand(event.userId(), event.couponCode(), event.subtotal())
        );
    }
}
```
ë˜í•œ event publisherëŠ” DIPë¥¼ ì ìš©í•˜ì—¬ ë„ë©”ì¸ ë ˆì´ì–´ì— interfaceë¥¼, infrastructure ë ˆì´ì–´ì— êµ¬í˜„ì²´ë¥¼ ë‘ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
```java
// domain/payment/PaymentEventPublisher.java - ë„ë©”ì¸ ë ˆì´ì–´ì— ì¸í„°í˜ì´ìŠ¤ ì •ì˜
public interface PaymentEventPublisher {
    void publish(PaymentEvent event);
}

// infrastructure/payment/PaymentEventPublisherImpl.java - Infrastructure ë ˆì´ì–´
@Component
public class PaymentEventPublisherImpl implements PaymentEventPublisher {
    private final ApplicationEventPublisher applicationEventPublisher;

    @Override
    public void publish(PaymentEvent event) {
        // âœ… Infrastructureì—ì„œ ì‹¤ì œ ì´ë²¤íŠ¸ ë°œí–‰ êµ¬í˜„
        applicationEventPublisher.publishEvent(event);
    }
}
```
ê·¸ë¦¬ê³  event listenerëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ëŠ” ì—­í• ë§Œ í•˜ë¯€ë¡œ interface ë ˆì´ì–´ì— ë‘ì—ˆìŠµë‹ˆë‹¤.
```java
// interface/event/PaymentEventListener.java - Interface ë ˆì´ì–´
@Component
public class PaymentEventListener {
    private final PaymentEventHandler paymentEventHandler;  // âœ… Event Handler í˜¸ì¶œë§Œ ë‹´ë‹¹

    @EventListener
    public void handle(PaymentEvent event) {
        paymentEventHandler.handle(event);
    }
}
```
**ë ˆì´ì–´ë³„ ì±…ì„:**
- **Domain ë ˆì´ì–´**: Event ì •ì˜ (ë„ë©”ì¸ ê·œì¹™ í‘œí˜„), EventPublisher ì¸í„°í˜ì´ìŠ¤ ì •ì˜
- **Application ë ˆì´ì–´**: Event Handler êµ¬í˜„ (Application ì„œë¹„ìŠ¤ ì‚¬ìš©)
- **Infrastructure ë ˆì´ì–´**: EventPublisher êµ¬í˜„ì²´ (ì‹¤ì œ ì´ë²¤íŠ¸ ë°œí–‰ ê¸°ìˆ  êµ¬í˜„)
- **Interface ë ˆì´ì–´**: Event Listener (ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í˜¸ì¶œ ì—­í• ë§Œ ë‹´ë‹¹)

**ê°œì„  íš¨ê³¼:**
- ë„ë©”ì¸ ê·œì¹™ì„ í‘œí˜„í•˜ëŠ” Eventê°€ ë„ë©”ì¸ ë ˆì´ì–´ì— ìœ„ì¹˜í•˜ì—¬ ì‘ì§‘ë„ í–¥ìƒ
- DIP ì¤€ìˆ˜: EventPublisher ì¸í„°í˜ì´ìŠ¤ë¥¼ ë„ë©”ì¸ ë ˆì´ì–´ì— ì •ì˜í•˜ì—¬ ì¸í”„ë¼ ì˜ì¡´ì„± ì œê±°
- ë ˆì´ì–´ë³„ ì±…ì„ì´ ëª…í™•íˆ ë¶„ë¦¬ë˜ì–´ ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
- Event ListenerëŠ” ë‹¨ìˆœíˆ í•¸ë“¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ëŠ” ì—­í• ë§Œ ë‹´ë‹¹í•˜ì—¬ ë‹¨ìˆœì„± ìœ ì§€

---
### 3. êµ¬ë§¤ ì‹¤íŒ¨ ì „ëµ (ë³´ìƒ íŠ¸ëœì­ì…˜)
ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë¥¼ ë„ì…í•˜ë©´ì„œ ê° ë„ë©”ì¸ì´ ë…ë¦½ì ì¸ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë™ì‘í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ê²°ì œ ì‹¤íŒ¨ ì‹œ ì´ë¯¸ ì°¨ê°ëœ ì¬ê³ ì™€ í¬ì¸íŠ¸ë¥¼ ì›ë³µí•´ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë³´ìƒ íŠ¸ëœì ì…˜ì„ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.

#### 1) ê²°ì œ ì‹¤íŒ¨ íë¦„
ê²°ì œ ì‹¤íŒ¨ ì‹œ ë³´ìƒ íŠ¸ëœì­ì…˜ì„ í†µí•´ ë¦¬ì†ŒìŠ¤ë¥¼ ì›ë³µí•©ë‹ˆë‹¤:
```
PaymentFailed ì´ë²¤íŠ¸ ë°œí–‰
    â†“
OrderEventHandler.handlePaymentFailed()
    â†“
OrderService.cancelOrder()
    â†“
OrderCanceled ì´ë²¤íŠ¸ ë°œí–‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ProductEventHandler     â”‚ PointEventHandler       â”‚
â”‚ handleOrderCanceled()   â”‚ handleOrderCanceled()   â”‚
â”‚ ì¬ê³  ì›ë³µ                â”‚ í¬ì¸íŠ¸ í™˜ë¶ˆ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2) ê²°ì œ ì‹¤íŒ¨ ì²˜ë¦¬ êµ¬í˜„
ì´ë²¤íŠ¸ ê¸°ë°˜ ì‹œìŠ¤í…œì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜, ì¬ì‹œë„ ë“±ìœ¼ë¡œ ì¸í•´ ë™ì¼í•œ ì´ë²¤íŠ¸ê°€ ì—¬ëŸ¬ ë²ˆ ì²˜ë¦¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë©±ë“±ì„±ì„ ë³´ì¥í•˜ì§€ ì•Šìœ¼ë©´ ì¬ê³ ê°€ ì¤‘ë³µìœ¼ë¡œ ì›ë³µë˜ê±°ë‚˜ í¬ì¸íŠ¸ê°€ ì¤‘ë³µìœ¼ë¡œ í™˜ë¶ˆë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì´ ë©±ë“±ì„±ì„ ë³´ì¥í•˜ë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.
```java
// OrderEventHandler.java
@Transactional
public void handlePaymentFailed(PaymentEvent.PaymentFailed event) {
    Order order = orderService.getOrder(event.orderId()).orElse(null);
    if (order == null) {
        log.warn("ê²°ì œ ì‹¤íŒ¨ ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹œ ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (orderId: {})", event.orderId());
        return;
    }

    // âœ… ë©±ë“±ì„± ë³´ì¥: ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸ì¸ ê²½ìš° ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
    if (order.isCanceled()) {
        log.debug("ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤. ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ê±´ë„ˆëœë‹ˆë‹¤. (orderId: {})", event.orderId());
        return;
    }

    // âœ… ì£¼ë¬¸ ì·¨ì†Œ (OrderCanceled ì´ë²¤íŠ¸ ë°œí–‰ í¬í•¨)
    // PaymentFailed ì´ë²¤íŠ¸ì— í¬í•¨ëœ refundPointAmount ì‚¬ìš©
    orderService.cancelOrder(event.orderId(), event.reason(), event.refundPointAmount());
    log.info("ê²°ì œ ì‹¤íŒ¨ë¡œ ì¸í•œ ì£¼ë¬¸ ì·¨ì†Œ ì™„ë£Œ. (orderId: {}, reason: {}, refundPointAmount: {})",
            event.orderId(), event.reason(), event.refundPointAmount());
}
```

#### 3) ë¦¬ì†ŒìŠ¤ ì›ë³µ ì²˜ë¦¬
ì—¬ëŸ¬ ë„ë©”ì¸ì´ ë™ì‹œì— ë¦¬ì†ŒìŠ¤ë¥¼ ì›ë³µí•  ë•Œ, ì„œë¡œ ë‹¤ë¥¸ ìˆœì„œë¡œ ë½ì„ íšë“í•˜ë©´ Deadlockì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Thread Aê°€ Product ë½ì„ íšë“í•œ í›„ User ë½ì„ ê¸°ë‹¤ë¦¬ê³ , Thread Bê°€ User ë½ì„ íšë“í•œ í›„ Product ë½ì„ ê¸°ë‹¤ë¦¬ë©´ Deadlockì´ ë°œìƒí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ë‹¤ë¥¸ ë¡œì§ê³¼ ìˆœì„œë¥¼ ì§€ì¼œ ë½ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

#### ì¬ê³  ì›ë³µ

```java
// ProductEventHandler.java
@Transactional
public void handleOrderCanceled(OrderEvent.OrderCanceled event) {
    if (event.orderItems() == null || event.orderItems().isEmpty()) {
        log.debug("ì£¼ë¬¸ ì•„ì´í…œì´ ì—†ì–´ ì¬ê³  ì›ë³µì„ ê±´ë„ˆëœë‹ˆë‹¤. (orderId: {})", event.orderId());
        return;
    }

    try {
        // âœ… Deadlock ë°©ì§€: ìƒí’ˆ IDë¥¼ ì •ë ¬í•˜ì—¬ ì¼ê´€ëœ ë½ íšë“ ìˆœì„œ ë³´ì¥
        List<Long> sortedProductIds = event.orderItems().stream()
                .map(OrderEvent.OrderCanceled.OrderItemInfo::productId)
                .distinct()
                .sorted()
                .toList();

        // ì •ë ¬ëœ ìˆœì„œëŒ€ë¡œ ìƒí’ˆ ë½ íšë“ (Deadlock ë°©ì§€)
        Map<Long, Product> productMap = new HashMap<>();
        for (Long productId : sortedProductIds) {
            Product product = productService.getProductForUpdate(productId);
            productMap.put(productId, product);
        }

        // ì¬ê³  ì›ë³µ
        for (OrderEvent.OrderCanceled.OrderItemInfo itemInfo : event.orderItems()) {
            Product product = productMap.get(itemInfo.productId());
            if (product == null) {
                log.warn("ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (orderId: {}, productId: {})",
                        event.orderId(), itemInfo.productId());
                continue;
            }
            product.increaseStock(itemInfo.quantity());
        }

        // ì €ì¥
        productService.saveAll(productMap.values().stream().toList());

        log.info("ì£¼ë¬¸ ì·¨ì†Œë¡œ ì¸í•œ ì¬ê³  ì›ë³µ ì™„ë£Œ. (orderId: {})", event.orderId());
    } catch (Exception e) {
        log.error("ì£¼ë¬¸ ì·¨ì†Œ ì´ë²¤íŠ¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ. (orderId: {})", event.orderId(), e);
        throw e;
    }
}
```

#### í¬ì¸íŠ¸ í™˜ë¶ˆ
í¬ì¸íŠ¸ë„ ë™ì¼í•œ ê¸°ì¤€ìœ¼ë¡œ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.
```java
// PointEventHandler.java
@Transactional
public void handleOrderCanceled(OrderEvent.OrderCanceled event) {
    // âœ… ë©±ë“±ì„± ë³´ì¥: í™˜ë¶ˆí•  í¬ì¸íŠ¸ ê¸ˆì•¡ì´ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
    if (event.refundPointAmount() == null || event.refundPointAmount() == 0) {
        log.debug("í™˜ë¶ˆí•  í¬ì¸íŠ¸ ê¸ˆì•¡ì´ ì—†ì–´ í¬ì¸íŠ¸ í™˜ë¶ˆ ì²˜ë¦¬ë¥¼ ê±´ë„ˆëœë‹ˆë‹¤. (orderId: {})", event.orderId());
        return;
    }

    try {
        // âœ… Deadlock ë°©ì§€: User ë½ì„ ë¨¼ì € íšë“í•˜ì—¬ createOrderì™€ ë™ì¼í•œ ë½ íšë“ ìˆœì„œ ë³´ì¥
        User user = userService.getUserById(event.userId());
        if (user == null) {
            log.warn("ì£¼ë¬¸ ì·¨ì†Œ ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹œ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (orderId: {}, userId: {})",
                    event.orderId(), event.userId());
            return;
        }

        // ë¹„ê´€ì  ë½ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì¡°íšŒ (í¬ì¸íŠ¸ í™˜ë¶ˆ ì‹œ ë™ì‹œì„± ì œì–´)
        User lockedUser = userService.getUserForUpdate(user.getUserId());

        // í¬ì¸íŠ¸ í™˜ë¶ˆ
        lockedUser.receivePoint(Point.of(event.refundPointAmount()));
        userService.save(lockedUser);

        log.info("ì£¼ë¬¸ ì·¨ì†Œë¡œ ì¸í•œ í¬ì¸íŠ¸ í™˜ë¶ˆ ì™„ë£Œ. (orderId: {}, userId: {}, refundPointAmount: {})",
                event.orderId(), event.userId(), event.refundPointAmount());
    } catch (Exception e) {
        log.error("í¬ì¸íŠ¸ í™˜ë¶ˆ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ. (orderId: {}, userId: {}, refundPointAmount: {})",
                event.orderId(), event.userId(), event.refundPointAmount(), e);
        throw e;
    }
}
```

#### 4) ë©±ë“±ì„± ë³´ì¥

ë³´ìƒ íŠ¸ëœì­ì…˜ì˜ ë©±ë“±ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì²´í¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤:

- **OrderEventHandler**: ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸ì¸ ê²½ìš° ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
- **ProductEventHandler**: ì£¼ë¬¸ ì•„ì´í…œì´ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
- **PointEventHandler**: í™˜ë¶ˆí•  í¬ì¸íŠ¸ ê¸ˆì•¡ì´ 0ì¸ ê²½ìš° ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ

#### 5) Deadlock ë°©ì§€

ë™ì‹œì„± ì œì–´ë¥¼ ìœ„í•´ ì¼ê´€ëœ ë½ íšë“ ìˆœì„œë¥¼ ë³´ì¥í•©ë‹ˆë‹¤:

- **ì¬ê³  ì›ë³µ**: ìƒí’ˆ IDë¥¼ ì •ë ¬í•˜ì—¬ ì¼ê´€ëœ ë½ íšë“ ìˆœì„œ ë³´ì¥
- **í¬ì¸íŠ¸ í™˜ë¶ˆ**: User ë½ì„ ë¨¼ì € íšë“í•˜ì—¬ `createOrder`ì™€ ë™ì¼í•œ ë½ íšë“ ìˆœì„œ ë³´ì¥

---
### 4. ë¦¬íŒ©í† ë§: Application ë ˆì´ì–´ ì±…ì„ ë¶„ë¦¬ ë° DIP ì¤€ìˆ˜
application ë ˆì´ì–´ì— ë¡œì§ë“¤ì´ ì§‘ì¤‘ë˜ì–´ êµ¬ë§¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” `PurchasingFacade`ê°€ ë„ˆë¬´ ë§ì€ ì±…ì„ì„ ê°€ì§€ë©° ë¡œì§ë“¤ì„ ì´í•´í•˜ê¸° ë‚œí•´í•˜ê²Œ êµ¬ì„±ëœ ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ë„ë©”ì¸ ë ˆì´ì–´ë¡œ ì±…ì„ë“¤ì„ ë¶„ë¦¬í•˜ê³ , ë‹¨ì¼ ë„ë©”ì¸ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬í–ˆìœ¼ë©° íŒŒì‚¬ë“œëŠ” ê° ë„ë©”ì¸ë³„ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë¥¼ ì¡°í•©í•˜ëŠ” ì—­í• ë§Œ í•˜ë„ë¡ ì¬êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì½”ë“œì˜ ì‘ì§‘ë„ë¥¼ ë†’ì´ê³  ê²°í•©ë„ë¥¼ ë‚®ì¶œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

#### 1) ë„ë©”ì¸ì˜ ë¶„ë¦¬

ì§€ë‚œì£¼ì°¨ì— ì œê°€ ê²°ì œ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì„ í‘œí˜„í•˜ë©° ê´€ë ¨ ì±…ì„ì„ ë‹´ë‹¹í•˜ëŠ” ë„ë©”ì¸ì„ ì ì ˆí•˜ê²Œ ë¶„ë¦¬í•˜ì§€ ì•Šì€ ì ì„ í™•ì¸í•˜ì—¬ payment ë„ë©”ì¸ì„ ìƒˆë¡œ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

#### (1) payment ë„ë©”ì¸ ë¶„ë¦¬

ê²°ì œ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ê³¼ ë¡œì§ì´ `PurchasingFacade`ì— ë¶„ì‚°ë˜ì–´ ìˆì–´ ê²°ì œ ë„ë©”ì¸ì˜ ì±…ì„ì´ ëª…í™•í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. payment ë„ë©”ì¸ì„ ìƒˆë¡œ ë¶„ë¦¬í•˜ì—¬ ê²°ì œ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ê³¼ ë¡œì§ì„ í•œ ê³³ì— ëª¨ì•˜ìŠµë‹ˆë‹¤.

#### Before: ê²°ì œ ë¡œì§ì´ PurchasingFacadeì— ë¶„ì‚°

```java
// application/purchasing/PurchasingFacade.java
@Component
public class PurchasingFacade {
    private final PaymentGatewayAdapter paymentGatewayAdapter;  // âŒ Infra ì§ì ‘ ì˜ì¡´

    public OrderInfo createOrder(...) {
        // ê²°ì œ ìƒì„±, PG ìš”ì²­, ì‹¤íŒ¨ ë¶„ë¥˜, íƒ€ì„ì•„ì›ƒ ë³µêµ¬ ë“± ëª¨ë“  ë¡œì§ì´ Facadeì— ë¶„ì‚°
        Payment payment = new Payment(...);
        PaymentResult result = paymentGatewayAdapter.requestPayment(...);
        if (isBusinessFailure(result.errorCode())) { ... }
    }

    private boolean isBusinessFailure(String errorCode) { ... }  // ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ Facadeì—
}
```

**ë¬¸ì œì :**
- ê²°ì œ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ `PurchasingFacade`ì— ë¶„ì‚°ë˜ì–´ ìˆìŒ
- ê²°ì œ ë„ë©”ì¸ì˜ ì±…ì„ì´ ëª…í™•í•˜ì§€ ì•ŠìŒ
- ê²°ì œ ë¡œì§ ì¬ì‚¬ìš©ì´ ì–´ë ¤ì›€
- ê²°ì œ ê´€ë ¨ í…ŒìŠ¤íŠ¸ê°€ ë³µì¡í•¨ (Facade ì „ì²´ë¥¼ í…ŒìŠ¤íŠ¸í•´ì•¼ í•¨)
- ì¸í”„ë¼ ì˜ì¡´ì„±(`PaymentGatewayAdapter`)ì´ Application ë ˆì´ì–´ì— ì§ì ‘ ë…¸ì¶œë¨

#### After: payment ë„ë©”ì¸ìœ¼ë¡œ ë¶„ë¦¬

```java
// domain/payment/Payment.java - ê²°ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ìº¡ìŠí™”
@Entity
public class Payment {
    public static Payment create(...) {
        // ê²°ì œ ìƒì„± ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
        Long paidAmount = totalAmount - usedPoint;
        PaymentStatus status = (paidAmount == 0) ? PaymentStatus.PAID : PaymentStatus.PENDING;
        return new Payment(...);
    }

    public void complete(String transactionKey) { ... }
    public void fail(String errorCode, String message) { ... }
}

// domain/payment/PaymentService.java - ê²°ì œ ë„ë©”ì¸ ì„œë¹„ìŠ¤
@Service
public class PaymentService {
    private final PaymentGateway paymentGateway;  // âœ… ë„ë©”ì¸ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´

    public PaymentRequestResult requestPayment(PaymentRequestCommand command) {
        Payment payment = Payment.create(...);
        PaymentRequestResult result = paymentGateway.requestPayment(command);
        // ê²°ì œ ì²˜ë¦¬ ë¡œì§...
        return result;
    }
}

// application/purchasing/PurchasingFacade.java
@Component
public class PurchasingFacade {
    private final PaymentService paymentService;  // âœ… payment ë„ë©”ì¸ ì„œë¹„ìŠ¤ì—ë§Œ ì˜ì¡´

    public OrderInfo createOrder(...) {
        PaymentRequestResult result = paymentService.requestPayment(...);
        return OrderInfo.from(order);
    }
}
```

**ê°œì„  íš¨ê³¼:**
- ê²°ì œ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ payment ë„ë©”ì¸ì— ì§‘ì¤‘ë˜ì–´ ì‘ì§‘ë„ í–¥ìƒ
- ê²°ì œ ë„ë©”ì¸ì˜ ì±…ì„ì´ ëª…í™•í•´ì§ (ê²°ì œ ìƒì„±, ìƒíƒœ ê´€ë¦¬, ì‹¤íŒ¨ ì²˜ë¦¬ ë“±)
- ê²°ì œ ë¡œì§ ì¬ì‚¬ìš© ê°€ëŠ¥: ë‹¤ë¥¸ Facadeì—ì„œë„ `PaymentService` ì‚¬ìš© ê°€ëŠ¥
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í–¥ìƒ: payment ë„ë©”ì¸ë§Œ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- DIP ì¤€ìˆ˜: `PaymentGateway` ì¸í„°í˜ì´ìŠ¤ë¥¼ ë„ë©”ì¸ ë ˆì´ì–´ì— ì •ì˜í•˜ì—¬ ì¸í”„ë¼ ì˜ì¡´ì„± ì œê±°

---

#### (2) ë„ë©”ì¸ ìº¡ìŠí™” ê°œì„ 

ë„ë©”ì¸ ìº¡ìŠí™”í•˜ì§€ ì•Šê³  getter ë©”ì†Œë“œë¡œ ì²˜ë¦¬í•œ ë¶€ë¶„ì„ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.  ë„ë©”ì¸ ì—”í‹°í‹°ì˜ ìƒíƒœë¥¼ ì§ì ‘ ë¹„êµí•˜ê±°ë‚˜ Value Objectë¥¼ ì§ì ‘ ë…¸ì¶œí•˜ë©´, ë„ë©”ì¸ ë¡œì§ì´ ì™¸ë¶€ë¡œ ë¶„ì‚°ë˜ì–´ ì‘ì§‘ë„ê°€ ë‚®ì•„ì§‘ë‹ˆë‹¤. ë„ë©”ì¸ ë©”ì†Œë“œë¡œ ì˜ë¯¸ë¥¼ ëª…í™•íˆ í‘œí˜„í•˜ë©´ ì½”ë“œ ê°€ë…ì„±ì´ í–¥ìƒë˜ê³ , ìƒíƒœ ë¹„êµ ë¡œì§ ë³€ê²½ ì‹œ í•œ ê³³ë§Œ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤.

#### Before: ìƒíƒœë¥¼ ì§ì ‘ ë¹„êµí•˜ëŠ” ì½”ë“œ

```java
// PurchasingFacade.java
if (order.getStatus() == OrderStatus.COMPLETED || order.getStatus() == OrderStatus.CANCELED) {
    log.info("ì´ë¯¸ ì™„ë£Œë˜ê±°ë‚˜ ì·¨ì†Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤.");
    return true;
}
```

#### After: ë„ë©”ì¸ ë©”ì†Œë“œë¡œ ì˜ë¯¸ë¥¼ ëª…í™•íˆ í‘œí˜„

```java
// PurchasingFacade.java
if (order.isCompleted() || order.isCanceled()) {
    log.debug("ì´ë¯¸ ì™„ë£Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤. ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ê±´ë„ˆëœë‹ˆë‹¤. (orderId: {})", orderId);
    return true;
}

// Order.java (ë„ë©”ì¸ ì—”í‹°í‹°)
public boolean isCompleted() {
    return this.status == OrderStatus.COMPLETED;
}

public boolean isCanceled() {
    return this.status == OrderStatus.CANCELED;
}
```

**ê°œì„  íš¨ê³¼:**
- ë„ë©”ì¸ ë¡œì§ì´ ì—”í‹°í‹° ë‚´ë¶€ì— ìº¡ìŠí™”ë˜ì–´ ì‘ì§‘ë„ í–¥ìƒ
- ì½”ë“œ ê°€ë…ì„± í–¥ìƒ ë° ì˜ë„ ëª…í™•í™”
- ìƒíƒœ ë¹„êµ ë¡œì§ ë³€ê²½ ì‹œ í•œ ê³³ë§Œ ìˆ˜ì •í•˜ë©´ ë¨

---

#### Before: Value Objectë¥¼ ì§ì ‘ ë…¸ì¶œ

```java
// UserService.java
public static PointsInfo from(User user) {
    return new PointsInfo(user.getUserId(), user.getPoint().getValue());
}
```

#### After: ë„ë©”ì¸ ë©”ì†Œë“œë¡œ ìº¡ìŠí™”

```java
// UserService.java
public static PointsInfo from(User user) {
    return new PointsInfo(user.getUserId(), user.getPointValue());
}

// User.java (ë„ë©”ì¸ ì—”í‹°í‹°)
public Long getPointValue() {
    return this.point.getValue();
}
```

**ê°œì„  íš¨ê³¼:**
- Value Objectì˜ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ì™¸ë¶€ì— ë…¸ì¶œí•˜ì§€ ì•ŠìŒ
- ë„ë©”ì¸ ëª¨ë¸ì˜ ìº¡ìŠí™” ê°•í™”

---

#### (3) PaymentFailureClassifierë¥¼ ë„ë©”ì¸ìœ¼ë¡œ ì´ë™

ê²°ì œ ì‹¤íŒ¨ ë¶„ë¥˜ëŠ” ê²°ì œ ë„ë©”ì¸ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì…ë‹ˆë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì€ ë„ë©”ì¸ ê³„ì¸µì— ìœ„ì¹˜í•´ì•¼ í•˜ë©°, ì´ë¥¼ enumì˜ ì •ì  ë©”ì†Œë“œë¡œ í‘œí˜„í•˜ë©´ ì¬ì‚¬ìš©ì„±ê³¼ í…ŒìŠ¤íŠ¸ ìš©ì´ì„±ì´ í–¥ìƒë©ë‹ˆë‹¤.

#### Before: Application ë ˆì´ì–´ì˜ ë„ë©”ì¸ ì„œë¹„ìŠ¤

```java
// application/payment/PaymentFailureClassifier.java
@Component
public class PaymentFailureClassifier {
    public PaymentFailureType classify(String errorCode) {
        // ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ Application ë ˆì´ì–´ì— ìœ„ì¹˜
        return BUSINESS_FAILURE_CODES.stream().anyMatch(errorCode::contains)
            ? BUSINESS_FAILURE : EXTERNAL_SYSTEM_FAILURE;
    }
}

PaymentFailureType type = paymentFailureClassifier.classify(errorCode);
```

#### After: ë„ë©”ì¸ enumì˜ ì •ì  ë©”ì†Œë“œë¡œ ì´ë™

```java
// domain/payment/PaymentFailureType.java
public enum PaymentFailureType {
    BUSINESS_FAILURE, EXTERNAL_SYSTEM_FAILURE;

    public static PaymentFailureType classify(String errorCode) {
        // âœ… ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ ë„ë©”ì¸ ê³„ì¸µì— ìœ„ì¹˜
        return BUSINESS_FAILURE_CODES.stream().anyMatch(errorCode::contains)
            ? BUSINESS_FAILURE : EXTERNAL_SYSTEM_FAILURE;
    }
}

PaymentFailureType type = PaymentFailureType.classify(errorCode);
```

**ê°œì„  íš¨ê³¼:**
- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ ë„ë©”ì¸ ê³„ì¸µì— ìœ„ì¹˜í•˜ì—¬ ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬
- ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ì—ì„œ ì¬ì‚¬ìš© ê°€ëŠ¥
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í–¥ìƒ (ì •ì  ë©”ì†Œë“œë¡œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê°„ì†Œí™”)

---

#### 2) Application ì„œë¹„ìŠ¤ì™€ Facadeì˜ ë¶„ë¦¬

ì§€ë‚œì£¼ì°¨ê¹Œì§€ 'ë„ë©”ì¸ ì„œë¹„ìŠ¤ëŠ” ìƒíƒœ(repository)ë¥¼ ê°–ì§€ ì•ŠëŠ”ë‹¤', 'íŒŒì‚¬ë“œëŠ” ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¥¼ ì¡°í•©í•˜ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë‹¤'ë¼ëŠ” ë‘ ê¸°ì¤€ìœ¼ë¡œë§Œ êµ¬ì„±í•˜ì—¬ ëª¨ë“  ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë¥¼ facadeë¡œ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ê° ë„ë©”ì¸ ë‹¨ë…ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ë„ ìœ ì¦ˆì¼€ì´ìŠ¤ë³„ë¡œ ë³„ë„ì˜ í´ë”ê°€ ìƒê¸°ë‹¤ ë³´ë‹ˆ ë¶ˆí•„ìš”í•˜ê²Œ ë³µì¡í•´ì§€ê³ , ì¬ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë„ë©”ì¸ì˜ ê·œì¹™ê³¼ ì±…ì„ì„ ìƒê°í•˜ì§€ ì•Šê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

#### (1) ë¬¸ì œ ìƒí™©

ì˜ˆë¥¼ ë“¤ì–´ `signup`, `userinfo`ë¡œ êµ¬ì„±í•˜ë‹¤ë³´ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:

#### Before: ìœ ì¦ˆì¼€ì´ìŠ¤ë³„ í´ë” êµ¬ì¡°ë¡œ ì¸í•œ ë³µì¡ì„±

```
application/
â”œâ”€â”€ signup/
â”‚   â””â”€â”€ SignUpService.java      # íšŒì›ê°€ì… ë¡œì§
â””â”€â”€ userinfo/
    â””â”€â”€ UserInfoService.java    # ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ë¡œì§
```

**ë¬¸ì œì :**
- ê°™ì€ ë„ë©”ì¸(User)ì˜ ë¡œì§ì´ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¡œ ë¶„ì‚°ë¨
- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë„ë©”ì¸ ê·œì¹™ì„ ìƒê°í•˜ì§€ ì•Šê²Œ ë¨
- ìœ ì¦ˆì¼€ì´ìŠ¤ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ í´ë”ì™€ ì„œë¹„ìŠ¤ê°€ ê³„ì† ì¦ê°€

#### 2.2 ê°œì„ : ë„ë©”ì¸ë³„ Application ì„œë¹„ìŠ¤ë¡œ í†µí•©

#### After: ë„ë©”ì¸ë³„ Application ì„œë¹„ìŠ¤ êµ¬ì¡°

```
application/
â””â”€â”€ user/
    â””â”€â”€ UserService.java         # User ë„ë©”ì¸ì˜ ëª¨ë“  ì–´í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ í†µí•©
```

**ê°œì„  íš¨ê³¼:**
- ë‹¨ì¼ ë„ë©”ì¸ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ì´ í•œ ê³³ì— ëª¨ì—¬ ì‘ì§‘ë„ í–¥ìƒ
- ë„ë©”ì¸ì˜ ê·œì¹™ê³¼ ì±…ì„ì„ ëª…í™•íˆ íŒŒì•… ê°€ëŠ¥
- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë¡œì§ì„ ì‰½ê²Œ ì‹ë³„ ê°€ëŠ¥

#### (3) FacadeëŠ” ì—¬ëŸ¬ ë„ë©”ì¸ ì¡°í•©ë§Œ ë‹´ë‹¹

ì—¬ëŸ¬ ë„ë©”ì¸ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë¥¼ ì¡°í•©í•´ì„œ í‘œí˜„í•´ì•¼í•˜ëŠ” ê²½ìš°ë§Œ, ë„ë©”ì¸ê³¼ëŠ” ë‹¤ë¥¸ ì´ë¦„ ì˜ˆë¥¼ ë“¤ì–´ `purchasing`, `heart`ì™€ ê°™ì€ ì´ë¦„ìœ¼ë¡œ ë³„ë„ì˜ íŒ¨í‚¤ì§€ë¥¼ ë§Œë“¤ì–´ facadeë¡œ ë¶„ë¦¬í–ˆìŠµë‹ˆë‹¤.

#### Before: ëª¨ë“  ë¡œì§ì´ Facadeì— ì§‘ì¤‘

```java
// PurchasingFacade.java
@Component
public class PurchasingFacade {
    private final UserRepository userRepository;           // âŒ Repository ì§ì ‘ ì˜ì¡´
    private final PaymentGatewayAdapter paymentGatewayAdapter;  // âŒ Infra ì§ì ‘ ì˜ì¡´

    public OrderInfo createOrder(...) {
        User user = userRepository.findByUserId(userId);
        Order order = new Order(...);
        orderRepository.save(order);
        PaymentResult result = paymentGatewayAdapter.requestPayment(...);
        // ìˆ˜ë°± ì¤„ì˜ ë³µì¡í•œ ë¡œì§...
    }
}
```

#### After: ë„ë©”ì¸ë³„ Application ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬ í›„ Facadeì—ì„œ ì¡°í•©

```java
// application/user/UserService.java
@Service
public class UserService {
    public User getUser(String userId) { ... }
}

// application/order/OrderService.java
@Service
public class OrderService {
    public Order createOrder(...) { ... }
}

// application/purchasing/PurchasingFacade.java
@Component
public class PurchasingFacade {
    private final UserService userService;           // âœ… ë„ë©”ì¸ë³„ Application ì„œë¹„ìŠ¤
    private final OrderService orderService;
    private final PaymentService paymentService;

    public OrderInfo createOrder(...) {
        User user = userService.getUser(userId);
        Order order = orderService.createOrder(...);
        PaymentRequestResult result = paymentService.requestPayment(...);
        return OrderInfo.from(order);
    }
}
```

**ê°œì„  íš¨ê³¼:**
- ê° ë„ë©”ì¸ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ì´ ëª…í™•íˆ ë¶„ë¦¬ë¨
- FacadeëŠ” ë„ë©”ì¸ ì„œë¹„ìŠ¤ ì¡°í•©ë§Œ ë‹´ë‹¹í•˜ì—¬ ë‹¨ìˆœí•´ì§
- ê° ë„ë©”ì¸ ì„œë¹„ìŠ¤ëŠ” ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- ì¬ì‚¬ìš©ì„± í–¥ìƒ: ë‹¤ë¥¸ Facadeì—ì„œë„ ë™ì¼í•œ ë„ë©”ì¸ ì„œë¹„ìŠ¤ ì‚¬ìš© ê°€ëŠ¥

---

#### 3) DIP ì›ì¹™ ì¤€ìˆ˜
Application ë ˆì´ì–´ê°€ Infrastructureë¥¼ ì§ì ‘ ì˜ì¡´í•˜ë©´, ë„ë©”ì¸ì´ ì¸í”„ë¼ ê¸°ìˆ ì— ì¢…ì†ë˜ì–´ í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ì›Œì§€ê³  ìœ ì—°ì„±ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤. DIPë¥¼ ì ìš©í•˜ë©´ ë„ë©”ì¸ì´ í•„ìš”ë¡œ í•˜ëŠ” ì¶”ìƒí™”ë¥¼ ë„ë©”ì¸ ë ˆì´ì–´ì— ì •ì˜í•˜ê³ , Infrastructureê°€ ì´ë¥¼ êµ¬í˜„í•˜ë¯€ë¡œ ì˜ì¡´ì„± ë°©í–¥ì´ ì—­ì „ë©ë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì DIPë¥¼ ì¤€ìˆ˜í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ê°œì„ í–ˆìŠµë‹ˆë‹¤.

#### (1) PG ì²˜ë¦¬ ì‹œ Applicationì´ Infraë¥¼ ì˜ì¡´í•˜ëŠ” ë¬¸ì œ í•´ê²°

#### Before: Application ë ˆì´ì–´ê°€ Infrastructure ì§ì ‘ ì˜ì¡´

```java
// application/purchasing/PurchasingFacade.java
@Component
public class PurchasingFacade {
    private final PaymentGatewayAdapter paymentGatewayAdapter;  // âŒ Infra ì§ì ‘ ì˜ì¡´

    public void requestPayment(...) {
        PaymentResult result = paymentGatewayAdapter.requestPayment(...);
    }
}
```

#### After: ë„ë©”ì¸ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ì˜ì¡´ì„± ì—­ì „

```java
// domain/payment/PaymentGateway.java (ë„ë©”ì¸ ì¸í„°í˜ì´ìŠ¤)
public interface PaymentGateway {
    PaymentRequestResult requestPayment(PaymentRequestCommand command);
}

// domain/payment/PaymentService.java
@Service
public class PaymentService {
    private final PaymentGateway paymentGateway;  // âœ… ë„ë©”ì¸ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
}

// infrastructure/payment/PaymentGatewayAdapter.java
@Component
public class PaymentGatewayAdapter implements PaymentGateway {
    // ì‹¤ì œ PG API í˜¸ì¶œ êµ¬í˜„
}

// application/purchasing/PurchasingFacade.java
@Component
public class PurchasingFacade {
    private final PaymentService paymentService;  // âœ… ë„ë©”ì¸ ì„œë¹„ìŠ¤ì—ë§Œ ì˜ì¡´
}
```

**ê°œì„  íš¨ê³¼:**
- DIP ì›ì¹™ ì¤€ìˆ˜: Application ë ˆì´ì–´ê°€ Infrastructureì— ì§ì ‘ ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- ë„ë©”ì¸ ë…ë¦½ì„± í™•ë³´: Payment ë„ë©”ì¸ì´ í•„ìš”ë¡œ í•˜ëŠ” ì¶”ìƒí™”ë¥¼ ë„ë©”ì¸ ë ˆì´ì–´ì— ì •ì˜
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í–¥ìƒ: PaymentGateway ì¸í„°í˜ì´ìŠ¤ë¥¼ Mockí•˜ì—¬ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

---

#### (2) ìºì‹œ ì²˜ë¦¬ ì‹œ DIP ìœ„ë°˜ í•´ê²°

#### Before: Application ë ˆì´ì–´ê°€ RedisTemplate ì§ì ‘ ì˜ì¡´

```java
// application/product/ProductCacheService.java
@Service
public class ProductCacheService {
    private final RedisTemplate<String, String> redisTemplate;  // âŒ Infra ì§ì ‘ ì˜ì¡´

    public ProductInfoList getCachedProductList(...) {
        String cachedValue = redisTemplate.opsForValue().get(cacheKey);
    }
}
```

#### After: ìºì‹œ ì¶”ìƒí™”ë¥¼ í†µí•œ ì˜ì¡´ì„± ì—­ì „

```java
// modules/redis/CacheTemplate.java (ì¸í„°í˜ì´ìŠ¤)
public interface CacheTemplate {
    <T> Optional<T> get(CacheKey<T> cacheKey);
    <T> void put(CacheKey<T> cacheKey, T value);
}

// modules/redis/RedisCacheTemplate.java (êµ¬í˜„ì²´)
@Component
public class RedisCacheTemplate implements CacheTemplate {
    // Redis êµ¬í˜„
}

// application/product/ProductCacheService.java
@Service
public class ProductCacheService {
    private final CacheTemplate cacheTemplate;  // âœ… ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
}
```

**ê°œì„  íš¨ê³¼:**
- DIP ì¤€ìˆ˜: Application ë ˆì´ì–´ê°€ ìºì‹œ ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í–¥ìƒ: CacheTemplate ì¸í„°í˜ì´ìŠ¤ë¥¼ Mockí•˜ì—¬ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- ìœ ì—°ì„± í–¥ìƒ: Redisì—ì„œ ë‹¤ë¥¸ ìºì‹œë¡œ ë³€ê²½ ì‹œ êµ¬í˜„ì²´ë§Œ êµì²´í•˜ë©´ ë¨

**ì°¸ê³ :** `CACHE_USAGE_COMPARISON_DDD_EVALUATION.md` ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ë“¤ì˜ ìºì‹œ ì‚¬ìš© ë°©ì‹ì„ ë¶„ì„í•˜ê³  ê°œì„ í–ˆìŠµë‹ˆë‹¤.

---

#### (3) Schedulerë¥¼ Infrastructure ë ˆì´ì–´ë¡œ ì´ë™

SchedulerëŠ” ë„ë©”ì¸ ê·œì¹™ì„ í‘œí˜„í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë‹¨ìˆœíˆ ê¸°ìˆ ì ì¸ ì„¤ì •ì´ë¯€ë¡œ Infrastructure ë ˆì´ì–´ì— ë°°ì¹˜í•˜ëŠ” ê²ƒì´ ì ì ˆí•©ë‹ˆë‹¤. ë„ë©”ì¸ ë¡œì§ì€ ë„ë©”ì¸ ì„œë¹„ìŠ¤ì— ìœ„ì„í•˜ì—¬ ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì¤€ìˆ˜í•©ë‹ˆë‹¤.

#### Before: Application ë ˆì´ì–´ì— Scheduler

```java
// application/payment/PaymentScheduler.java
@Component
public class PaymentScheduler {
    @Scheduled(fixedDelay = 5000)
    public void checkPaymentStatus() { ... }
}
```

#### After: Infrastructure ë ˆì´ì–´ë¡œ ì´ë™

```java
// infrastructure/payment/PaymentStatusScheduler.java
@Component
public class PaymentStatusScheduler {
    private final PaymentService paymentService;  // ë„ë©”ì¸ ì„œë¹„ìŠ¤ì— ì˜ì¡´
    @Scheduled(fixedDelay = 5000)
    public void checkPaymentStatus() { ... }
}
```

**ê°œì„  íš¨ê³¼:**
- ê¸°ìˆ ì  ê´€ì‹¬ì‚¬(scheduling)ê°€ Infrastructure ë ˆì´ì–´ì— ìœ„ì¹˜í•˜ì—¬ ë ˆì´ì–´ ì±…ì„ì´ ëª…í™•í•´ì§
- ë„ë©”ì¸ ë¡œì§ì€ ë„ë©”ì¸ ì„œë¹„ìŠ¤ì— ìœ„ì„í•˜ì—¬ ë‹¨ì¼ ì±…ì„ ì›ì¹™ ì¤€ìˆ˜


-->

## âœ… Checklist
- [x] **ì£¼ë¬¸ â†” ê²°ì œ ì´ë²¤íŠ¸ ê¸°ë°˜ ë¶„ë¦¬**
  - [x] ì£¼ë¬¸ ìƒì„±ê³¼ ì¿ í° ì‚¬ìš© ì²˜ë¦¬ë¥¼ ì´ë²¤íŠ¸ë¡œ ë¶„ë¦¬
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/application/coupon/CouponEventHandler.java`
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/domain/order/OrderEvent.java`
  - [x] ê²°ì œ ê²°ê³¼ì— ë”°ë¥¸ ì£¼ë¬¸ ì²˜ë¦¬ë¥¼ ì´ë²¤íŠ¸ë¡œ ë¶„ë¦¬
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/application/order/OrderEventHandler.java`
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/domain/payment/PaymentEvent.java`
  - [x] ì£¼ë¬¸/ê²°ì œ ê²°ê³¼ì— ëŒ€í•œ ë°ì´í„° í”Œë«í¼ ì „ì†¡ í›„ì†ì²˜ë¦¬
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/interfaces/event/data/DataEventListener.java`

- [x] **ì¢‹ì•„ìš” â†” ì§‘ê³„ ì´ë²¤íŠ¸ ê¸°ë°˜ ë¶„ë¦¬**
  - [x] ì¢‹ì•„ìš” ì²˜ë¦¬ì™€ ì§‘ê³„ë¥¼ ì´ë²¤íŠ¸ë¡œ ë¶„ë¦¬
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/application/product/ProductEventHandler.java`
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/domain/like/LikeEvent.java`
  - [x] ì§‘ê³„ ë¡œì§ì˜ ì„±ê³µ/ì‹¤íŒ¨ì™€ ë¬´ê´€í•˜ê²Œ ì¢‹ì•„ìš” ì²˜ë¦¬ëŠ” ì •ìƒ ì™„ë£Œ
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/interfaces/event/product/ProductEventListener.java` (ì˜ˆì™¸ ì²˜ë¦¬ í™•ì¸)

- [x] **ê³µí†µ ìš”ê±´**
  - [x] ì´ë²¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ìœ ì € í–‰ë™ì— ëŒ€í•œ ì„œë²„ ë ˆë²¨ ë¡œê¹… ë° ì¶”ì 
    - íŒŒì¼: `apps/commerce-api/src/main/java/com/loopers/interfaces/event/data/DataEventListener.java`
  - [x] ë™ì‘ì˜ ì£¼ì²´ë¥¼ ì ì ˆí•˜ê²Œ ë¶„ë¦¬í•˜ê³  íŠ¸ëœì­ì…˜ ê°„ ì—°ê´€ê´€ê³„ ê³ ë¯¼
    - Event Handler: `apps/commerce-api/src/main/java/com/loopers/application/*/EventHandler.java`
    - Event Listener: `apps/commerce-api/src/main/java/com/loopers/interfaces/event/*/EventListener.java`

## ğŸ“ References
- Source: https://github.com/Loopers-dev-lab/loopers-spring-java-template/pull/171
